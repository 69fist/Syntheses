\subsection{Terminology}
\subsubsection{Definition}
\begin{description}
    \item[Cryptography] Science that design algorithms to ensure
        confidentiality, authentication and Integrity of communication
        through insecure channels.
    \item[Confidentiality] Insurance that a given information cannot be accessed
        by unauthorized parties.
    \item[Cryptanalysis] Science that proves or disproves the security of
        cryptographic algorithm.
    \item[Break cryptographic algorithm] means either:
        \begin{itemize}
            \item Decrypting an encrypted message.
            \item Recovering the key of the cryptographic algorithm.
            \item Proving that a algorithm is less secure than what is claimed.
        \end{itemize}
    \item[Cryptology] Science of cryptography and Cryptanalysis.
\end{description}

\subsubsection{Attacker Model}
\begin{itemize}
    \item \textbf{Passive} adversary: ciphertext-only or known-plaintext
    \item \textbf{Active} adversary: chosen-plaintext or chosen-ciphertext
\end{itemize}

\subsubsection{Encryption Algorithm}
\begin{description}
    \item[Encryption algorithm] Algorithm that transforms an intelligible text
        into text that is unintelligible for non-authorized parties. 

        Usually parametrized with a cryptographic \textbf{key}

    \item[$\Rightarrow$]The input is the plaintext and the output is the ciphertext.
\end{description}


\subsection{Encryption}

\subsubsection{Cryptographic algorithm categories}
\begin{itemize}
    \item \textbf{Symmetric-key cryptography} where the same key is used for both encryption and
        decryption.

        \begin{itemize}
            \item Based on bit or byte operations.
            \item Tend to be fast.
            \item Typical key-size: 128 bits
            \item Best attack is the exhaustive search.
        \end{itemize}
        
        \begin{center}
        \begin{tabular}{|c|c|c|}
            \hline
            \textbf{Ciphers}&\textbf{Key size} (bits)&\textbf{Block
        size} (bits)\\
            \hline
            DES & 56(+8)& 64\\
            3DES & 168 &64\\
            AES & 128/129/256&128\\
            \hline
        \end{tabular}
        \end{center}

        \paragraph{Note:} DES is known to not be secure anymore.

        \begin{center}
            \scriptsize
            \begin{tabular}{cc}
                \begin{tikzpicture}
                    \node (P) {Plain};
                    \node [draw, rectangle, right= of P] (E) {Enc};
                    \node [ right= of E] (C) {Cipher};
                    \node [ above= 0.4cm of E] (k) {k};

                    \draw[->] (P) -- (E);
                    \draw[->] (k) -- (E);
                    \draw[->] (E) -- (C);
                \end{tikzpicture}
                &
                \begin{tikzpicture}
                    \node (P) {Cipher};
                    \node [draw, rectangle, right= of P] (E) {Decr};
                    \node [ right= of E] (C) {Plain};
                    \node [ above= 0.4cm of E] (k) {k};

                    \draw[->] (P) -- (E);
                    \draw[->] (k) -- (E);
                    \draw[->] (E) -- (C);
                \end{tikzpicture}
            \end{tabular}
        \end{center}


    \item \textbf{Asymmetric-key cryptography} where there is a public key to encrypt and
        an private key to decrypt.

        \begin{itemize}
            \item Based on mathematical problems (Factorisation , Discrete log)
            \item Best attack exploit the mathematical structure.
            \item Typical key size: 1024 bits.
            \item Encryptions and decryptions are slow.
        \end{itemize}

        \paragraph{Certificate:} RSA stands for Rivest-Shamir-Adleman
        Certificate are used to \textbf{identify} of the key owner. A Certificate authority
        issue the certificate.
        
        \paragraph{Discrete logarithm problem} Given $p,g,g^a\mod p $ it's hard to 
        obtain $a$ (where p is prime number large enough)
        

        \begin{center}
            \scriptsize
            \begin{tabular}{cc}
                \begin{tikzpicture}
                    \node (P) {Plain};
                    \node [draw, rectangle, right= of P] (E) {Enc};
                    \node [ right= of E] (C) {Cipher};
                    \node [ above= 0.4cm of E] (k) {$k_{public}$};

                    \draw[->] (P) -- (E);
                    \draw[->] (k) -- (E);
                    \draw[->] (E) -- (C);
                \end{tikzpicture}
                &
                \begin{tikzpicture}
                    \node (P) {Cipher};
                    \node [draw, rectangle, right= of P] (E) {Decr};
                    \node [ right= of E] (C) {Plain};
                    \node [ above= 0.4cm of E] (k) {$k_{private}$};

                    \draw[->] (P) -- (E);
                    \draw[->] (k) -- (E);
                    \draw[->] (E) -- (C);
                \end{tikzpicture}
            \end{tabular}
        \end{center}

    \item \textbf{Hybrid encryption}: Combine benefits of both symmetric cryptography (speed) and
        asymmetric cryptography (key management).
        $$E_k(m) || E_{k_{pub}}(k)$$
\end{itemize}

\subsubsection{Cypher}
Symmetric-key algorithm can use Block ciphers or Stream ciphers. Block ciphers
acts on the plaintext in blocks. Stream ciphers acts on the plaintext one
symbol at a time.

\begin{center}
    \begin{tabular}{cc}
        Block cipher & Stream cipher\\
        \\
        \scriptsize
        \begin{tikzpicture}
            \node (P) {Block of size $b$};
            \node [draw, rectangle, right= of P] (E) {Algo};
            \node [ right= of E] (C) {Block of size $b$};
            \node [ above= 0.4cm of E] (k) {Key};

            \draw[->] (P) -- (E);
            \draw[->] (k) -- (E);
            \draw[->] (E) -- (C);
        \end{tikzpicture}
        &
        \begin{tikzpicture}
            \node (P) {Plain};
            \node [right= of P] (E) {$\oplus$};
            \node [ right= of E] (C) {Cipher};
            \node [ draw, rectangle, above= 0.4cm of E] (k) {Keystream
            generator};
            \node [left=0.2 of k] (s) {seed};

            \draw[->] (P) -- (E);
            \draw[->] (k) -- (E);
            \draw[->] (E) -- (C);
            \draw[->] (s) -- (k);
        \end{tikzpicture} 
    \end{tabular}
\end{center}

\subsubsection{Key management}
\begin{itemize}
    \item Parties can exchange their key 
        \begin{center}
            \scriptsize
            \begin{tabular}{ccc}
                A & & B \\
                Pick k & \fr{$E_{k_{pub_{B}}}(k)$} & \\
            \end{tabular}
        \end{center}
    \item or agree on shared key by using for example Diffie-Hellman 
        \begin{center}
            \scriptsize
            \begin{tabular}{ccc}
                A & & B \\
                Pick a & \fr{$g^a mod (p)$} & \\
                       & \fl{$g^b mod (p)$} & Pick b\\
                \\
            \multicolumn{3}{l}{Shared key: $g^{ab} mod (p)$}\\
            \end{tabular}
        \end{center}
\end{itemize}

\paragraph{Note}$$(g^a\mod p)\times (g^b \mod p) \ne g^{ab} \mod p = (g^b \mod p)^a \mod p$$


\subsection{Authentication and Integrity}
\begin{itemize}
    \item Entity authentication is asymmetric or symmmetric as
        challenge/response.
    \item Data authentication is
        asymmetric (signature) or symmetric (integrity check) as RSA or
        MAC.
\end{itemize}

\subsection{Hash Function}

$$h:\{0,1\}*\rightarrow\{0,1\}^n$$

\subsubsection{Properties}

\begin{itemize}
    \item \textbf{First preimage resistance}: Given a hash value $y$, it is infeasible to
        find $m$ such that $h(m) = y$.
    \item \textbf{Second preimage resistance}: Given a message $m_1$, it is infeasible
        to find a different message $m_2$ such that $h(m_1)=h(m_2)$.
    \item \textbf{Collision resistance}: It is infeasible to find two different messages
        $m_1$ and $m_2$ such that $h(m_1)=h(m_2)$
    \item \textbf{Random oracle property}: $h(m)$ is distinguishable from a
        random $n$-bit value.
\end{itemize}

\subsubsection{Attacks}
\begin{itemize}
    \item Find a \textit{preimage}: $2^n$
    \item Find \textit{collision}: Thanks to birthday paradox,
        we need about $\sqrt{2^n}$ hash operations to find a
        collision with probability $\frac{1}{2}$

        \paragraph{Birthday Paradox} If we pick $\theta\sqrt{N}$ random numbers,
        independently and uniformly, in {1,2,\ldots,N}, we get at least one number twice
        with probability:
        $$1-e^{-\frac{\theta^2}{2}}$$
\end{itemize}

\subsubsection{Message Authentication Code} 
Hash function that use a key where the naive idea is $h_k(m) = h(k||m)$

